<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text to Speech App with Voice and Speed Control</title>
    <link rel="stylesheet" href="tts.css">  <!-- Link to your updated CSS file -->
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 50px;
            background-color: #f4f4f4;
        }
        textarea {
            width: 100%;
            height: 100px;
            padding: 10px;
            font-size: 16px;
            margin-bottom: 20px;
        }
        select, input[type="range"] {
            margin-bottom: 20px;
            padding: 10px;
            font-size: 16px;
        }
        button {
            padding: 10px 20px;
            font-size: 18px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <h1>Text to Speech App with Voice and Speed Control</h1>
    
    <!-- Textarea for input text -->
    <textarea id="text" placeholder="Enter text here..."></textarea>
    <br>

    <!-- Dropdown for selecting a voice -->
    <select id="voices"></select>
    <br>

    <!-- Speed control slider -->
    <label for="rate">Speed: </label>
    <input type="range" id="rate" min="0.5" max="2" value="1" step="0.1">
    <span id="rateValue">1.0</span>
    <br>

    <!-- Button to trigger speech -->
    <button onclick="speak()">Speak</button>

    <script>
        const synth = window.speechSynthesis;
const voiceSelect = document.querySelector('#voiceSelect');

function populateVoices() {
    let voices = synth.getVoices();

    if (voices.length === 0) {
        // Try again after a short delay for mobile devices where voices might load slowly
        setTimeout(populateVoices, 100);
        return;
    }

    // Clear existing options
    voiceSelect.innerHTML = '';

    voices.forEach((voice) => {
        const option = document.createElement('option');
        option.textContent = `${voice.name} (${voice.lang})`;

        // Mark the voice as the default if it's the default system voice
        if (voice.default) {
            option.textContent += ' -- DEFAULT';
        }

        option.setAttribute('data-name', voice.name);
        option.setAttribute('data-lang', voice.lang);
        voiceSelect.appendChild(option);
    });
}

// Populate the voices list once the voices are loaded
populateVoices();

// Re-populate when voiceschange event is fired (this event is fired on some browsers when voices are updated)
if (synth.onvoiceschanged !== undefined) {
    synth.onvoiceschanged = populateVoices;
}

// Code to speak text using the selected voice
function speak() {
    if (synth.speaking) {
        console.error('SpeechSynthesis is already speaking.');
        return;
    }
    
    const utterThis = new SpeechSynthesisUtterance(document.querySelector('#textInput').value);
    const selectedOption = voiceSelect.selectedOptions[0].getAttribute('data-name');

    voices = synth.getVoices();
    utterThis.voice = voices.find((voice) => voice.name === selectedOption);

    synth.speak(utterThis);
    if (voiceSelect.length === 0) {
    const noVoiceOption = document.createElement('option');
    noVoiceOption.textContent = 'No voices available for this device';
    voiceSelect.appendChild(noVoiceOption);
        if (voiceSelect.length === 0) {
    const noVoiceOption = document.createElement('option');
    noVoiceOption.textContent = 'No voices available for this device';
    voiceSelect.appendChild(noVoiceOption);
}

}

}

document.querySelector('#speakButton').addEventListener('click', speak);

        }
    </script>
</body>
</html>
